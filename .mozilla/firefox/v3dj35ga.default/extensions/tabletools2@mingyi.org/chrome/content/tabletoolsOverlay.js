if("undefined"==typeof tabletools2){var tabletools2={u6:Components.classes["@mozilla.org/intl/stringbundle;1"].getService(Components.interfaces.nsIStringBundleService).createBundle("chrome://tabletools2/locale/tabletools.properties"),b5:Components.classes["@mozilla.org/intl/stringbundle;1"].getService(Components.interfaces.nsIStringBundleService).createBundle("chrome://tabletools2/locale/chart.properties"),b9:Components.classes["@mozilla.org/xre/app-info;1"].getService(Components.interfaces.nsIXULRuntime).OS==
"Darwin",x5:{y8:function(a){Components.classes["@mozilla.org/widget/clipboardhelper;1"].getService(Components.interfaces.nsIClipboardHelper).copyString(a)},b8:function(a){return tabletools2.b9?a.metaKey:a.ctrlKey},w3:Components.classes["@mozilla.org/file/directory_service;1"].getService(Components.interfaces.nsIProperties).get("TmpD",Components.interfaces.nsIFile),B5:function(a,b){var c=this.w3.clone(true);c.append(a);b||c.createUnique(Components.interfaces.nsIFile.NORMAL_FILE_TYPE,438);return c},
A1:function(a){var b="",c=Components.classes["@mozilla.org/network/file-input-stream;1"].createInstance(Components.interfaces.nsIFileInputStream),d=Components.classes["@mozilla.org/intl/converter-input-stream;1"].createInstance(Components.interfaces.nsIConverterInputStream);c.init(a,-1,0,0);d.init(c,"UTF-8",0,0);a={};c=0;do{c=d.readString(4294967295,a);b+=a.value}while(c!=0);d.close();return b},D2:function(a,b){var c=Components.classes["@mozilla.org/network/file-output-stream;1"].createInstance(Components.interfaces.nsIFileOutputStream);
c.init(a,42,438,0);var d=Components.classes["@mozilla.org/intl/converter-output-stream;1"].createInstance(Components.interfaces.nsIConverterOutputStream);d.init(c,"UTF-8",0,0);d.writeString(b);d.close()},J2:function(a){var b=Components.classes["@mozilla.org/file/local;1"].createInstance(Components.interfaces.nsILocalFile);b.initWithPath(a);return b},b7:function(a){return this.J2(this.c3(a))},c3:function(a){if(a&&/^chrome:/.test(a)){var b=Components.classes["@mozilla.org/network/io-service;1"].getService(Components.interfaces.nsIIOService),
c=Components.classes["@mozilla.org/chrome/chrome-registry;1"].getService(Components.interfaces.nsIChromeRegistry);a=b.newURI(a,"UTF-8",null);c=c.convertChromeURL(a).spec;return/^file:/.test(c)?this.x4(c):this.x4("file://"+c)}},x4:function(a){if(a&&/^file:/.test(a))return Components.classes["@mozilla.org/network/protocol;1?name=file"].createInstance(Components.interfaces.nsIFileProtocolHandler).getFileFromURLSpec(a).path},y4:function(a){return Components.classes["@mozilla.org/network/io-service;1"].getService(Components.interfaces.nsIIOService).newFileURI(this.b7(a)).spec},
C6:function(a,b){var c=Components.classes["@mozilla.org/appshell/window-mediator;1"].getService(Components.interfaces.nsIWindowMediator).getMostRecentWindow("navigator:browser").getBrowser(),d=tabletools2.x5.B5(a);tabletools2.x5.D2(d,b);d=c.addTab(d.path);c.selectedTab=d},z1:function(a){var b=this.j6(a),c=tabletools2.h0.i9(b,-1),d=c.i;b=c.v.length==0||!d?"string":tabletools2.t2.z0({b1:b.j8,x6:d,s8:"asc"}).x1;a.setAttribute("ttType",b);return b},y2:function(a){a=a?a.ownerDocument:content.document;
if(!a.getElementById("tabletools2_css")){var b=a.createElement("style");b.id="tabletools2_css";b.innerHTML=tabletools2.x5.A1(tabletools2.x5.b7("chrome://tabletools2/content/tt2.css"));a.getElementsByTagName("head")[0].appendChild(b)}},J5:function(a,b,c,d){if((b-=a.length)<=0)return a;b++;d=d||" ";c=c||3;c=c==1?b:c==3?0:Math.floor(b/2);return Array(c).join(d)+a+Array(b-c).join(d)},B7:function(a,b,c){if(!c)c=a.rows;var d={};if(typeof b!="object")d[b]=1;else d=b;if(!a.j9)a.j9={};for(b=0;b<c.length;b++)for(var e in d){var g=
this.i8(c[b],e,true);a.j9[e]=1;if(g)if(g.colSpan>1){g.colSpan--;g.w7=g.w7?g.w7+1:2}else{g.style.display="none";g.w7=1}}},z9:function(a){for(var b=0;b<a.rows.length;b++)for(var c=a.rows[b],d=0;d<c.cells.length;d++)if(c.cells[d].w7){c.cells[d].style.display="";c.cells[d].colSpan=c.cells[d].w7;c.cells[d].w7=0}a.j9=0},d4:function(a,b,c){var d=this.j2(a),e=d.cells.length;for(d=d.rowIndex;d<a.rows.length;d++){var g=a.rows[d];c<e-1?g.insertBefore(g.cells[b],g.cells[c]):g.appendChild(g.cells[b])}},e2:function(a,
b,c){b=a.rows[b];c>=a.rows.length?a.rows[a.rows.length-1].parentNode.appendChild(b):a.rows[c].parentNode.insertBefore(b,a.rows[c])},y5:function(a){if(a.d1)for(var b=0;b<a.d1.length;b++)this.q0(a.d1[b],"tt_found")},z6:function(a){if(a){a.ownerDocument.body.scrollTop=a.offsetTop;if(a.ownerDocument.body.scrollTop!=a.offsetTop)a.ownerDocument.body.parentNode.scrollTop=a.offsetTop}},z5:function(a){if(a&&a.tFoot){var b=a.offsetTop+a.tFoot.offsetTop;a.ownerDocument.body.scrollTop=b;if(a.ownerDocument.body.scrollTop!=
b)a.ownerDocument.body.parentNode.scrollTop=b}},K5:function(a){if(!a.cloneNode)return"";var b=content.document.createElement("div");b.appendChild(a.cloneNode(true));return b.innerHTML},i8:function(a,b,c){for(var d=-1,e=0;e<a.cells.length;e++){d+=a.cells[e].colSpan;if(d>=b)return c?a.cells[e]:e}return c?null:-1},j0:function(a,b){for(var c=0,d=0;d<b;d++)c+=a.cells[d].colSpan;return c},j2:function(a,b){for(var c=[],d=0,e=0;d<a.rows.length&&e<5;d++){var g=a.rows[d];if(!g.h6&&!g.className.match(/tt_summary/))c[e++]=
g}e={q7:c[0],c7:c[0].cells.length};for(d=1;d<c.length;d++){g=c[d];if(g.cells.length>e.c7){e.c7=g.cells.length;e.q7=g}}return b?e.q7.rowIndex:e.q7},j6:function(a){var b={};b.v7=this.j3(a,"TD|TH");b.h1=this.j3(a,"TABLE");b.w6=this.j3(a,"TR");if(b.v7){b.k2=b.v7.cellIndex;b.e9=this.j0(b.w6,b.k2);b.m9=this.j2(b.h1);b.n0=this.i8(b.m9,b.e9);b.j8=b.m9.cells[b.n0]}return b},h3:function(a,b){for(var c=0;c<a.style.length;c++)if(a.style[c]!="display")a.style[a.style[c]]="";if(b.length)for(c=0;c<b.length;c++)if(b[c]!=
"display")a.style[b[c]]=b[b[c]]},D0:function(a,b,c){if(!a)return a;a=a.replace(/^\s+/,"");if(b)a=a.replace(/[\n\r]+/g," ");if(c)a=a.replace(/\s+/g," ");return a.replace(/\s+$/,"")},y3:function(a){var b=a.q9?function(c){a.i1.call(a.q9,c)}:a.i1;if(a.g3&&a.g3.addEventListener){a.g3.addEventListener(a.x1,b,a.a9);return b}},removeEvent:function(a){a.g3&&a.g3.removeEventListener&&a.g3.removeEventListener(a.x1,a.i1,a.a9)},j3:function(a,b){if(a!=null)return a.nodeType==1&&a.tagName.match(RegExp("^("+b+")$",
"i"))?a:this.j3(a.parentNode,b)},j1:function(a){if(typeof a!="object")return a;var b="";a=a.childNodes;for(var c=0;c<a.length;c++)if(a[c].nodeType==3)b+=a[c].nodeValue;else if(a[c].nodeType==1)switch(a[c].tagName){case "SELECT":case "select":var d=a[c].childNodes[a[c].selectedIndex];b+=d.value||d.text;break;case "IMG":case "img":b+=a[c].alt;break;case "INPUT":case "input":if(a[c].type!="hidden")b+=a[c].value;break;default:b+=this.j1(a[c])}return b},A6:function(a,b){if(a){if(typeof b!="object")b=Array(b);
for(var c=0;c<b.length;c++)a.className+=" "+b[c]}},q0:function(a,b){if(a){if(typeof b!="object")b=Array(b);for(var c=0;c<b.length;c++)a.className=a.className.replace(RegExp("(?:^|\\s+)"+b[c]+"(?:\\s+|$)","ig")," ")}},B0:function(a,b){return(a.getTime()-b.getTime())/1E3}},t2:{E5:-2147483648E3,s8:1,r2:"[-. \\/]",n5:function(a,b){this.r4(b);if(!isNaN(this.e0(a)))return true;return false},j5:function(a){var b,c,d=tabletools2.c_.a1.dateStyle;if(a.match(/^\d{1,2}\D\d{1,2}\D\d{2,4}$/))b=d=="euro"?"D/M/Y":
"M/D/Y";else if(a.match(/^\d{2,4}\D\d{1,2}\D\d{1,2}$/))b=d=="euro"?"Y/D/M":"Y/M/D";else if(d=="euro"&&this.n5(a,"D/M/Y"))c="euro_date";else if(this.n5(a,"M/D/Y"))c="date";else if(a.match(/^\d{1,3}(\.\d{1,3}){3}$/))c="ip";else if(a.match(/^[+-]?\s*[\uc8c0$]\s*[-+]?\s*[0-9,.]+$|^\s*[+-]?\s*[0-9,.]+\s*%\s*$|^\s*[+-]?\s*[0-9,.]+(?:\s*[eE]\s*[+-]?\s*\d+)?\s*$/))c="number";else if(a.match(/^\w+\d+$/))c="alphanum";if(b)c="simple_date";return[c,b]},z0:function(a){var b=a.x2||a.b1.getAttribute("ttType"),c=
a.x6,d,e=this.t8;this.s8=a.s8=="desc"?-1:1;if((!b||a.g0)&&c&&c.length){for(var g={},h=0;h<c.length;h++){var f=this.j5(c[h]);if(f[0])if(g[f[0]])g[f[0]][0]++;else g[f[0]]=[1,f[1]]}for(h in g)if(g[h][0]>=c.length/1.3){b=h;g[h][1]&&a.b1.setAttribute("ttDateFormat",g[h][1])}b||(b="string")}switch(b){case "date":d="M/D/Y";break;case "euro_date":d="D/M/Y";break;case "year_month_date":d="Y/M/D";break;case "year_date_month":d="Y/D/M";break;case "simple_date":this.r4(a.b1.getAttribute("ttDateFormat"));e=this.t6;
break;case "number":case "money":e=this.t5;break;case "alphanum":e=this.s5;break;case "ip":e=this.t4;break;case "string":break;default:b&&alert(b+" "+tabletools2.c_.a1.unsupportedType)}if(d&&c&&c.length){this.n5(c[0],d);e=this.s7}a.g0||a.b1.setAttribute("ttType",b);return{i1:e,x1:b}},r4:function(a){var b=[["D",a.indexOf("D")],["M",a.indexOf("M")],["Y",a.indexOf("Y")]];b.sort(function(d,e){return d[1]-e[1]});this.f9=Array(3);this.s4={};for(var c=0;c<3;c++){this.f9[b[c][0]]="$"+(c+2);this.s4[b[c][0]]=
c}this.q3=a.replace(/[DMY]\D[DMY]\D[DMY]/,"^(s*)(\\d+)"+this.r2+"(\\d+)"+this.r2+"(\\d+)(.*)$")},p6:function(a){var b=parseInt(a);return b<32?"20"+a:b<100?"19"+a:a},e0:function(a){if(!isNaN(a))return"a";if(a.match(this.q3))a=RegExp.$1+RegExp[this.f9.M]+"/"+RegExp[this.f9.D]+"/"+this.p6(RegExp[this.f9.Y])+RegExp.$5;return Date.parse(a)},z4:function(a){if(a&&a.match(/\S/)){var b=tabletools2.t2.e0(a);if(isNaN(b))b=Date.parse(a);if(isNaN(b))b=tabletools2.t2.E5+1;return b}return tabletools2.t2.E5},s7:function(a,
b,c){if(a[0]!=b[0])return a[0]-b[0];var d=a[1],e=b[1];if(!((isNaN(d)&&a[1]||isNaN(e)&&b[1])&&c))return tabletools2.t2.s8*(d-e)},E7:function(a){if(a&&a.match(/\S/)){if(!isNaN(a))return a-0;var b=tabletools2.c_.a1.decimalPoint;a=a.replace(RegExp("[^-+0-9eE"+b+"]+","g"),"");b=parseFloat(b=="."?a:a.replace(RegExp(b,"g"),"."));return!isNaN(b)?b-0:tabletools2.t2.E5+1}return tabletools2.t2.E5},t6:function(a,b,c){if(a[0]!=b[0])return a[0]-b[0];var d=a[1].split(/\D+/),e=b[1].split(/\D+/),g=tabletools2.t2.s4;
if(!((d.length!=3&&a[1]||e.length!=3&&b[1])&&c)){a=tabletools2.t2.p6;b=tabletools2.t2.E7;return(a(d[g.Y])-a(e[g.Y])||b(d[g.M])-b(e[g.M])||b(d[g.D])-b(e[g.D]))*tabletools2.t2.s8}},t5:function(a,b,c){if(a[0]!=b[0])return a[0]-b[0];a=a[1];b=b[1];if(!((a==tabletools2.t2.E5+1||b==tabletools2.t2.E5+1)&&c))return tabletools2.t2.s8*(a-b)},t4:function(a,b,c){if(a[0]!=b[0])return a[0]-b[0];var d=a[1].split("."),e=b[1].split("."),g=tabletools2.t2.E7;if(!((d.length!=4&&a[1]||e.length!=4&&b[1])&&c))return(g(d[0])-
g(e[0])||g(d[1])-g(e[1])||g(d[2])-g(e[2])||g(d[3])-g(e[3]))*tabletools2.t2.s8},t8:function(a,b){if(a[0]!=b[0])return a[0]-b[0];var c=a[1],d=b[1];return(c==d?0:c<d?-1:1)*tabletools2.t2.s8},s5:function(a,b){if(a[0]!=b[0])return a[0]-b[0];var c=a[1],d=b[1],e=0;if(c==d)return 0;else if(c)if(d){var g;if(c.match(/^(\S*\D)(\d+)$/)){c=RegExp.$1;e=RegExp.$2-0}else e=-1;if(d.match(/^(\S*\D)(\d+)$/)){d=RegExp.$1;g=RegExp.$2-0}else g=-1;e=c>d?1:c<d?-1:e-g}else e=1;else e=-1;return tabletools2.t2.s8*e},r9:function(a,
b,c){if(!(!a||!a.length||!b||b==this.t4||b==this.t6)){b=b==this.s7?"date":b==this.t5?"number":"string";for(var d=0;d<a.length;d++){var e;switch(b){case "date":e=this.z4(a[d][1]);break;case "number":e=this.E7(a[d][1]);break;case "string":e=a[d][1].toLowerCase()}if(c)a[d][3]=a[d][1];a[d][1]=e}}}},h0:{C0:function(a,b){for(var c=a.h1,d=a.w6.rowIndex,e=0,g=0;g<c.rows.length;g++){var h=c.rows[g];if(h.h6||h.className.match(/tt_summary/))e++;if(g==d)break}c.setAttribute("ttSkipRows"+b,d-e)},A4:function(a){a.removeAttribute("ttSkipRowsup");
a.removeAttribute("ttSkipRowsdown")},A5:function(a){var b=a.getAttribute("ttSkipRowsdown"),c=a.getAttribute("ttSkipRowsup");this.v5(a);if(c==null){for(var d=0;d<a.rows.length;d++){var e=a.rows[d];if(!(e.h6||e.className.match(/tt_summary/)||!/tbody/i.test(e.parentNode.tagName))){c=d;break}}e=tabletools2.x5.j2(a,true);if(e>=c)c=e+1}else{d=c-0+1;for(var g=0;g<a.rows.length;g++){e=a.rows[g];!e.h6&&!e.className.match(/tt_summary/)&&d--;if(!d)break}c=g}if(b==null)for(d=a.tBodies.length-1;d>=0;d--){e=a.tBodies[d].rows;
if(e.length){b=e[e.length-1].rowIndex;break}}else{d=b-0+1;for(g=0;g<a.rows.length;g++){e=a.rows[g];!e.h6&&!e.className.match(/tt_summary/)&&d--;if(!d)break}b=g}this.t7=c;this.t1=b},v5:function(a){if(a.tHead&&a.tHead.rows.length>0)for(var b=0;b<a.tHead.rows.length;b++)if(!a.tHead.rows[b].h6)return true;return false},i9:function(a,b){for(var c=[],d=[],e=[],g=[],h=[],f=a.h1,k=0,m=this.t7;m<=this.t1;m++){var i=f.rows[m],n=tabletools2.x5.i8(i,a.e9,true);if(n){n=tabletools2.x5.D0(tabletools2.x5.j1(n));
var o=0;if(this.o2&&i.p7&&i.p7.length)if(a.e9==b){if(i.p7.length>1)o=i.p7[i.p7.length-2]}else o=i.p7[i.p7.length-1];c[k]=[o||0,n,k];if(i.style.display!="none"){h.push(i);g.push([0,n,k])}d[k++]=i;n&&e.push([n,n.length])}}f=[];e.sort(function(v,w){return w[1]-v[1]});for(k=0;k<e.length&&k<10;k++)f.push(e[k][0]);return{s:c,n:d,i:f.length?f:null,v:g,f:h}},C3:function(a,b,c,d){var e=b||tabletools2.x5.j6(a);b=e.h1;var g=e.m9;c=this.t7;var h=e.e9,f=e.j8;a=new Date;var k=b.s6&&b.s6.length?b.s6[b.s6.length-
1]:-1,m=f.getAttribute("ttSortDir"),i=f.s8,n=(i=="asc"?"desc":i=="desc"?"asc":null)||m||tabletools2.c_.a1.initSortDir;i=this.i9(e,k);var o=i.s;m=i.n;var v=i.i;if(!(o.length==0||!v)){i=tabletools2.c_.a1.preserveStyle;var w,x;if(i=="row"||i=="cell"){w=[];for(var l=0;l<m.length;l++)w.push([m[l].className,m[l].style,m[l].bgColor])}if(i=="cell"){x=[];for(l=0;l<m.length;l++)for(var u=0;u<m[l].cells.length;u++){x[l]||(x[l]=[]);var s=m[l].cells[u];x[l].push([s.className,s.style,s.bgColor])}}d=tabletools2.t2.z0({b1:e.j8,
x6:v,s8:n,x2:d});tabletools2.t2.r9(o,d.i1);o.sort(d.i1);if(b.s6&&b.s6.length)for(l=0;l<b.s6.length;l++)if(!(this.o2&&(h!=k||l<b.s6.length-1))){u=tabletools2.x5.i8(g,b.s6[l],true);if(u.firstChild){e=l?l>4?4:l:"";tabletools2.x5.q0(u,["tt_icon_desc"+e,"tt_icon_asc"+e])}}if(f.firstChild){e=(l=this.o2&&b.s6&&b.s6.length?b.s6.length-(h==k?1:0):0)?l>4?4:l:"";tabletools2.x5.A6(f,n=="desc"?"tt_icon_desc"+e:"tt_icon_asc"+e)}f.s8=n;if(this.o2){if(!b.s6){b.s6=[];b.t0=[]}if(h!=k){b.s6.push(h);b.t0.push(n)}else b.t0[b.t0.length-
1]=n}else{b.s6=[h];b.t0=[n]}g=new Date;h=[];for(l=this.t1+1;l<b.rows.length;l++){f=b.rows[l];if(/tfoot/i.test(f.parentNode.tagName))break;h.push(f)}for(l=0;l<m.length;l++)b.tBodies[0].appendChild(m[o[l][2]]);for(l=0;l<h.length;l++)b.tBodies[0].appendChild(h[l]);for(u=l=0;l<o.length;l++){h=l+c;if(!b.rows[h].p7||!this.o2)b.rows[h].p7=[];b.rows[h].p7[b.s6.length-1]=!l||d.i1(o[l-1],o[l])?++u:u}if(i=="row"||i=="cell")for(l=0;l<m.length;l++){o=b.rows[l+c];o.className=w[l][0];tabletools2.x5.h3(o,w[l][1]);
o.bgColor=w[l][2]}if(i=="cell")for(l=0;l<m.length;l++)for(u=0;u<m[l].cells.length;u++){o=b.rows[l+b.w5].cells[u];o.className=x[l][u][0];tabletools2.x5.h3(o,x[l][u][1]);o.bgColor=x[l][u][2]}w=new Date;if(tabletools2.c_.a1.reportSpeed){alert(tabletools2.c_.u7.itTook+tabletools2.x5.B0(g,a)+" "+tabletools2.c_.u7.sortStyleTime+i+" "+tabletools2.c_.u7.styleStr);alert(tabletools2.c_.u7.itTook+tabletools2.x5.B0(w,g)+" "+tabletools2.c_.u7.arrangeRowTime+i+" "+tabletools2.c_.u7.styleStr)}}}},g9:{e5:function(a,
b,c){var d=tabletools2.x5.j2(a),e=d.cells.length,g=content.document.createElement("tr");b.appendChild(g);g.h6=c;for(b=0;b<e;b++){var h=content.document.createElement("td");g.appendChild(h);if(c==1){var f=content.document.createElement("input");h.appendChild(f);f.type="TEXT";f.className="tt_it";f.size=3;tabletools2.x5.y3({g3:f,x1:"change",i1:this.g1,q9:this})}else{f=content.document.createElement("select");h.appendChild(f);f.options.add(new Option(tabletools2.c_.u7.defaultFilterOption,tabletools2.c_.u7.defaultFilterOption));
tabletools2.x5.y3({g3:f,x1:"mousedown",i1:this.r6,q9:this});tabletools2.x5.y3({g3:f,x1:"change",i1:this.g1,q9:this});tabletools2.x5.y3({g3:f,x1:"focus",i1:this.g8,q9:this});f.className="tt_sel"}}this.k0(a,d,g.rowIndex,c);a.w8=a.w8?a.w8+c:c;a.j9&&tabletools2.x5.B7(a,a.j9,Array(g))},k0:function(a,b,c,d,e){for(var g=tabletools2.x5.j0(b,b.cells.length);c<=b.rowIndex;c++){var h=a.rows[c];if(tabletools2.x5.j0(h,h.cells.length)>g){e?this.q1(h,d):this.r8(h,d);this.r5(h)}}},C9:function(a,b){var c=a.h1,d=0;
b||(b=3);if(c.w8){for(var e=c.w8=0;e<c.tHead.rows.length;e++){var g=c.tHead.rows[e].h6;if(g)if(b==3||g==b){c.deleteRow(e--);d+=g}else c.w8+=g}d&&this.q4(c,d)}if(b!=d){if(c.tHead)e=c.tHead;else{e=content.document.createElement("thead");c.appendChild(e)}if((b==1||b==3)&&(!d||d==2))this.e5(c,e,1);if(b>=2&&d<2){this.e5(c,e,2);tabletools2.c_.a1.delayFilterFill||this.p4(a,-1)}}},r6:function(a){this.k9=a.shiftKey?true:false},g8:function(a){if(tabletools2.c_.a1.delayFilterFill){a=tabletools2.x5.j6(a.target);
a.h1&&a.v7&&a.h1.rows.length>=tabletools2.c_.a1.minimumSortRow&&this.p4(a,a.k2)}},p4:function(a,b){var c,d=a.h1,e=this.h9(d,2);tabletools2.h0.A5(d);for(var g=0;g<d.rows[e].cells.length;g++)if(!(tabletools2.c_.a1.delayFilterFill&&b>-1&&g!=b)){var h=d.rows[e].cells[g].firstChild;if(!h.x7){var f=tabletools2.x5.j6(d.rows[e].cells[g]);c=tabletools2.h0.i9(f,-1);f=c.v;var k=c.f;c=c.i;if(k.length==0)break;c=tabletools2.t2.z0({b1:a.j8,x6:c});k=c.i1;tabletools2.t2.r9(f,c.i1,true);f.sort(k);c=h.selectedIndex;
var m=h.options;m.length=1;for(var i=0;i<f.length;i++)if(!i||k(f[i-1],f[i])!=0)m.add(new Option(f[i][3]==null?f[i][1]:f[i][3],f[i][1]));h.x7=true;if(c>0)m[1].selected=true}}},h9:function(a,b){for(var c=0;c<a.rows.length;c++)if(a.rows[c].h6==b)return c;return-1},r8:function(a,b){var c=a.t3;a.t3=c==3||c&&c!=b?3:b},s1:function(a,b,c){b>=0&&b<a.cells.length&&this.r8(a.cells[b],c);this.r8(a,c)},q1:function(a,b){var c=a.t3;if(c==b||b==3)a.t3=0;else if(c==3)a.t3=3-b},q2:function(a,b,c){b>=0&&b<a.cells.length&&
this.q1(a.cells[b],c);for(var d=0;d<a.cells.length;d++){b=a.cells[d].t3;if(b==3||b==c)return}this.q1(a,c)},r5:function(a){a.style.display=a.t3?"none":""},q4:function(a,b){if(a.tHead){b||(b=3);for(var c=0;c<a.tHead.rows.length;c++){var d=a.tHead.rows[c];if(d.h6==1&&(b==1||b==3))for(j=0;j<d.cells.length;j++)d.cells[j].firstChild.value="";else if(d.h6==2&&b>=2)for(j=0;j<d.cells.length;j++)d.cells[j].firstChild.options[0].selected=true}this.q5(a,b)}},q5:function(a,b){b||(b=3);for(var c=0;c<a.rows.length;c++){var d=
a.rows[c];if(d.parentNode.tagName.toLowerCase()=="tbody"){this.q1(d,b);for(var e=0;e<d.cells.length;e++)this.q1(d.cells[e],b);this.r5(d)}}a.w9&&tabletools2.H5.p9(a)},g1:function(a){var b=a.target;a=tabletools2.x5.j6(b);var c=a.h1,d=a.v7;if(!(!c||c.rows.length<tabletools2.c_.a1.minimumSortRow||!d)){d=/input/i.test(b.tagName)?1:2;var e;b=a.k2;var g=this.h9(c,d);g=c.rows[g];tabletools2.x5.y5(c);var h=new Date,f=g.cells[b].firstChild;f=d==1?f.value:f.options[f.selectedIndex].value||f.options[f.selectedIndex].text;
var k=false;if(d==1)if(f.match(/^:INV:(.*)/)){this.k9=true;f=RegExp.$1}else if(f.match(/^:ALL:(.*)/)){f=RegExp.$1;k=true;this.k9=false}else if(f.match(/^:INVALL:(.*)/)){f=RegExp.$1;k=this.k9=true}else k=this.k9=false;var m=g.cells[b].firstChild;this.k9?tabletools2.x5.A6(m,"tt_inv"):tabletools2.x5.q0(m,"tt_inv");var i=[],n=false,o;if(f.match(/^\s*([<=>]+)\s*([^<=>&|]+)\s*(?:([&|]+)\s*([<=>]+)\s*([^<=>&|]+)\s*)?$/)){i.push([RegExp.$1,RegExp.$2]);(o=RegExp.$3)&&i.push([RegExp.$4,RegExp.$5]);i[0][1]=
tabletools2.x5.D0(i[0][1]);if(o)i[1][1]=tabletools2.x5.D0(i[1][1])}if(i.length)n=true;var v={},w={},x=RegExp(f,"i");for(m=tabletools2.h0.t7;m<=tabletools2.h0.t1;m++){e=c.rows[m];for(var l=false,u,s=0;s<g.cells.length;s++)if(!(s!=b&&!k)){w[s]||(w[s]=tabletools2.x5.j0(g,s));var q=tabletools2.x5.i8(e,w[s]);if(q==-1)break;q=e.cells[q];if(q.style.display!="none"){var p=tabletools2.x5.j1(q);if(!v[s]){var t=tabletools2.x5.j6(q),r=tabletools2.h0.i9(t,-1).i;t=tabletools2.t2.z0({b1:t.j8,x6:r});v[s]=t.i1}t=
[[0,p],[0,f]];tabletools2.t2.r9(t,v[s]);if(d==1)if(n){p=[[0,i[0][1]]];tabletools2.t2.r9(p,v[s]);r=v[s](t[0],p[0],true);p=this.d9(r,i[0][0]);if(o){r=[[0,i[1][1]]];tabletools2.t2.r9(r,v[s]);r=v[s](t[0],r[0],true);t=this.d9(r,i[1][0]);p=o.match(/&/)?p&&t:p||t}}else p=f==""||x.test(p)||v[s](t[1],t[0],true)==0;else p=f==tabletools2.c_.u7.defaultFilterOption||v[s](t[1],t[0])==0;if(p){l=true;u=q}}}!this.k9&&l||this.k9&&!l?this.q2(e,b,d):this.s1(e,b,d);if(k&&!this.k9&&u!=undefined){tabletools2.x5.A6(u,"tt_found");
if(!c.d1)c.d1=[];c.d1.push(u)}this.r5(e)}tabletools2.c_.a1.reportSpeed&&alert(tabletools2.c_.u7.itTook+tabletools2.x5.B0(new Date,h)+" "+tabletools2.c_.u7.filterTime);o=this.h9(c,2);if(o>=0)for(m=0;m<c.rows[o].cells.length;m++)c.rows[o].cells[m].firstChild.x7=false;if(!tabletools2.c_.a1.delayFilterFill||f==tabletools2.c_.u7.defaultFilterOption)this.p4(a,b);c.w9&&tabletools2.H5.p9(c)}},d9:function(a,b){switch(b){case ">":return a>0;case ">=":return a>=0;case "<":return a<0;case "<=":return a<=0;case "=":return a==
0}}},H5:{A3:function(a){a=a.h1;var b=tabletools2.x5.j2(a);if(a.w9){for(var c=a.w9=0;c<a.tFoot.rows.length;c++)a.tFoot.rows[c].className.match(/tt_summary/)&&a.tFoot.deleteRow(c--);tabletools2.g9.k0(a,b,0,4,true)}else{a.w9=1;var d;if(a.tFoot)d=a.tFoot;else{d=content.document.createElement("tfoot");a.appendChild(d)}var e=b.cells;b=e.length;var g={},h=[];a.u8=[];for(c=0;c<b;c++){var f;f=e[c].getAttribute("ttType");var k={};f||(f=tabletools2.x5.z1(e[c]));f=f.match(/number|money/)?"min|max|avg|med|sd|sum|cnt":
"min|max|cnt";e[c].setAttribute("tt2Sum",f);var m=f.split("|");for(f=0;f<m.length;f++){var i=m[f],n=tabletools2.u6.GetStringFromName(m[f]);g[n]||h.push(n);k[n]=i;g[n]=i}a.u8[c]=k}e=[];for(c=0;c<h.length;c++){g=content.document.createElement("tr");d.appendChild(g);g.className="tt_summary";g.title=h[c];for(f=0;f<b;f++){k=content.document.createElement("td");g.appendChild(k);k.className="tt_summary"}e.push(g)}a.j9&&tabletools2.x5.B7(a,a.j9,e);this.p9(a)}},p9:function(a){if(a.w9){var b=a.tFoot,c=tabletools2.x5.j2(a);
b=c.cells;for(var d=b.length,e=[],g=[],h=0;h<d;h++)if(b[h].getAttribute("tt2Sum")){var f=tabletools2.x5.j6(b[h]),k=tabletools2.h0.i9(f,-1),m=k.v;k=k.i;if(!(m.length==0||!k)){k=tabletools2.t2.z0({b1:f.j8,x6:k,s8:"asc"});var i=k.x1,n=[];tabletools2.t2.r9(m,k.i1,true);m.sort(k.i1);for(f=0;f<m.length;f++)n.push([m[f][1],m[f][3]]);e[h]=n;g[h]={i1:k.i1,x1:i}}}b=a.tFoot;for(h=0;h<b.rows.length;h++){m=b.rows[h];if(m.className.match(/tt_summary/))for(f=0;f<d;f++)if(a.u8[f]&&a.u8[f][m.title])if(e[f]&&e[f].length)m.cells[f].innerHTML=
(tabletools2.c_.a1.showSumLabels?m.title+": ":"")+this.d7(e[f],a.u8[f][m.title],null,g[f])}tabletools2.g9.k0(a,c,0,4)}},A2:function(a){if(!a.w9)return 0;a=a.tFoot;for(var b=0,c=0;c<a.rows.length;c++){var d=a.rows[c];if(d.className.match(/tt_summary/))if(d.title.length>b)b=d.title.length}return b},d7:function(a,b,c,d){for(var e=0,g=0,h=0,f=0,k,m=d.x1.match(/number|money/),i=0;i<a.length;i++){var n=a[i][0],o=a[i][1]==null?n:a[i][1];if(m)if(isNaN(n)||n<tabletools2.t2.E5+2)continue;else{if(k==null)k=
o;if(b=="med"||b=="min")break;g+=n-0;e++;if(c)h+=(n-c)*(n-c)}else if(o){e++;if(k==null)k=o}if(o&&(!i||d&&d.i1([0,a[i-1][0]],[0,n],true)))f++}c=e?(g/e).toFixed(2):"";switch(b){case "min":return k||"";case "max":return a[a.length-1][1]!=null?a[a.length-1][1]:a[a.length-1][0];case "sum":return g.toFixed(2);case "cnt":return e+"/"+f;case "avg":return c;case "sd":return this.d7(a,"sd1",c,d);case "sd1":return e>1?Math.sqrt(h/(e-1)).toFixed(2):"";case "med":if(i<a.length){i=(i-1+a.length)/2;b=Math.floor(i);
i=Math.ceil(i);return b==i?a[b][1]==null?a[b][0]:a[b][1]:((a[b][0]+a[i][0])/2).toFixed(2)}else return""}}},d3:{d8:"",v4:0,A7:function(a,b){var c=tabletools2.e3.e3(a,"tab",null,true,true,true),d=c.split(/[\n\r]+/),e=[];this.v4++;if(b!="compare")if(this.v4<2)this.d8=c;else this.d8+=(/\n$/.test(this.d8)?"":"\n")+d.slice(1).join("\n");else{var g=prompt(tabletools2.u6.GetStringFromName("tablecolname"),tabletools2.u6.GetStringFromName("Table")+this.v4);if(!g&&this.v4<2)this.d8=c;else{if(g){var h=d[0].split(/\t/);
for(c=0;c<h.length;c++)h[c]=g+" "+h[c];d[0]=h.join("\t")}if(this.v4<2)e=d;else{g=this.d8.split(/[\n\r]+/);for(c=0;c<g.length;c++)e.push(g[c]+"\t"+d[c])}this.d8=e.join("\n")}}},v2:function(a,b){var c=[],d=a.split(/[\n\r]+/);if(b==null)b=0;c.push('<TABLE class="tt_e2" width="100%" cellspacing="1" cellpadding="1" border="0">\n');for(var e=0;e<d.length;e++)if(!d[e].match(/^\s*$/)){c.push('<tr class="'+(e%2?"odd":"even")+'">\n');for(var g=d[e].split("\t"),h=e>b?"td":"th",f=0;f<g.length;f++)c.push("<"+
h+">"+g[f]+"</"+h+">");c.push("</tr>\n")}c.push("</TABLE>");return c.join("")},y6:function(){this.d8="";this.v4=0;alert(tabletools2.u6.GetStringFromName("combinedcleared"))},A0:function(){var a=tabletools2.u6.GetStringFromName("combinedtable");tabletools2.x5.C6("tt2combined",'<html>\n<head>\n<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>\n<title>TableTools2 '+a+'</title><style>\n.tt_e2 { border:1px solid gray; border-collapse:collapse; font:normal 12px verdana, sans-serif; }.tt_e2 thead tr { padding:3px; text-transform:uppercase; text-align:left; background:#ccf; }.tt_e2 td, .tt_e2 th { border:1px solid gray; }.tt_e2 tbody tr.odd { background:#ddd; }.tt_e2 tbody tr.even { background:#bbb; }.tt_e2 tbody tr:hover { background:#faa; border:1px dotted gray; }</style>\n</head>\n<body>\n<div style="text-align:center">\n<h3><a href="http://mingyi.org">TableTools2</a> '+
a+"</h3>\n"+this.v2(this.d8)+"</div>\n</body></html>")}},K4:{i5:1.2,a7:["chart_by","data_in","data_in_col","data_in_row","data_sep","data_sep_tab","data_sep_comma","reset_data","chart_type","please_select","bubble_chart","frequency_chart","chart_histogram","line_chart","pie_chart","scatter_chart","chart_title","chart_subtitle","show_data","chart_row","chart_col","irregular_data","chart_axis","chart_required","chart_label","chart_none","chart_category","chart_size","chart_color","how_many_slices",
"draw_chart","must_have_data","chart_data","must_choose_category","chart_count","chart_locale","chart_page_by","hide_data"],y9:function(a){var b=a.h1,c=[],d=[],e=[],g=tabletools2.x5.j2(b,true),h=[];a=tabletools2.c_.a1.decimalPoint;if(b&&b.rows.length){for(var f=g,k=0;f<b.rows.length;f++){var m=b.rows[f];if(!(m.h6||m.style.display=="none"||m.className.match(/tt_summary/)||f&&!/tbody/i.test(m.parentNode.tagName))){for(var i=0;i<m.cells.length;i++)if(k)for(var n=tabletools2.x5.D0(tabletools2.x5.j1(m.cells[i]),
true)||" ",o=0;o<m.cells[i].colSpan;o++)h.push((i+o?"\t":"")+n);else{c[i]=tabletools2.x5.z1(m.cells[i]);n=tabletools2.x5.D0(tabletools2.x5.j1(m.cells[i]),true,true);if(e[n])d[i]=n+e[n]++;else{d[i]=n;e[n]=1}}k++;f==g&&h.push(c.join("\t"),"\\n",d.join("\t"),"\\n");f>g&&h.push("\\n")}}b=h.join("").replace(/'/g,"\\'").replace(/\\n$/,"");f=tabletools2.x5.B5("tt2chart",true);d=f.path;e=false;g=f.clone();h="chart"+this.i5;k=tabletools2.x5.b7("chrome://tabletools2/content/tt2chart");m=false;c=f.clone();g.append(h);
if(f.exists())if(g.exists())e=true;else try{f.remove(true)}catch(v){alert(tabletools2.c_.u7.cannotDelete+'"'+d+'" '+tabletools2.c_.u7.beforeProceed);return}var w={};for(f=0;f<this.a7.length;f++)w[this.a7[f]]=tabletools2.b5.GetStringFromName(this.a7[f]);c.append("tt2-chart.js");if(e){if(c.exists())if(tabletools2.x5.A1(c).indexOf("localeName = '"+w.chart_locale)>-1)m=true}else try{k.copyTo(tabletools2.x5.w3,"tt2chart");g.create(Components.interfaces.nsIFile.NORMAL_FILE_TYPE,438)}catch(x){alert(tabletools2.c_.u7.cannotCopy+
'"'+k.path+'" -> "'+tabletools2.x5.w3.path+'" '+tabletools2.c_.u7.createPlaceholder+'"'+h+'" -> "'+d+'" '+tabletools2.c_.u7.beforeProceed);return}if(!m){f=tabletools2.x5.A1(tabletools2.x5.b7("chrome://tabletools2/content/tt2-chart.js"));tabletools2.x5.D2(c,f.replace(RegExp("\\b("+this.a7.join("|")+")\\b","g"),function(l){return w[l]}))}f=tabletools2.x5.b7("chrome://tabletools2/content/tt2-chart.html");f=tabletools2.x5.A1(f);f=f.replace(RegExp("\\b("+this.a7.join("|")+")\\b","g"),function(l){return w[l]});
tabletools2.x5.C6("tt2graphs",f.replace('<script type="text/javascript" src="tt2-tabledata.js"><\/script>','<script type="text/javascript">\nvar numReg = new RegExp(\'[^-+0-9eE'+a+"]+', 'g'), tabledata = '"+b+"';<\/script>"))}}},e3:{L5:function(a,b,c,d,e,g,h,f){return g&&d!=e&&(d<h||d>f)||a.h6||a.style.display=="none"||b&&b!="col"&&!c[d]&&(d!=e||b=="row"&&!tabletools2.c_.a1.copyHeading4Row||b=="cell"&&!tabletools2.c_.a1.copyHeading4Cell)},e3:function(a,b,c,d,e,g){var h=a.h1,f="",k=[],m=new Date,i,
n,o,v=tabletools2.c_.a1.showSumLabels?0:tabletools2.H5.A2(h),w=tabletools2.h0.t7,x=tabletools2.h0.t1,l=tabletools2.x5.j2(h,true),u=h.rows[l].cells.length;if(c){var s=h.ownerDocument.defaultView.getSelection(),q=false;i={};n={};o={};if(s)for(var p=0;p<s.rangeCount;p++){var t=s.getRangeAt(p),r=t.startContainer;if((t=r.childNodes[t.startOffset])&&/tr/i.test(r.tagName)){r=r.rowIndex;q=t.cellIndex;i[r]=1;n[q]=1;o[r]||(o[r]={});o[r][q]=1;q=true}}if(!q){r=a.w6.rowIndex;q=a.k2;i[r]=1;n[q]=1;o[r]||(o[r]={});
o[r][q]=1}}if(b=="html"){if(!h.cloneNode)return;k=h.cloneNode(true);v=k.rows.length;for(p=0;p<v;p++){r=k.rows[p];if(r.h6||r.style.display=="none"){k.deleteRow(p);p--;v--}}f+=k.K5||tabletools2.x5.K5(k)}else if(b=="tab"){for(p=0;p<h.rows.length;p++){r=h.rows[p];if(!this.L5(r,c,i,p,l,g,w,x)){if(v)k.push(r.className.match(/tt_summary/)?r.title:"","\t");for(t=q=0;q<r.cells.length&&(!e||q<u);q++)if(r.cells[q].style.display!="none"&&(!c||c=="row"||c=="col"&&n[q]||c=="cell"&&n[q]&&(p==l||o[p])))for(var A=
c=="cell"&&p!=l&&!o[p][q]?"":tabletools2.x5.D0(tabletools2.x5.j1(r.cells[q]),true,true),y=0;y<r.cells[q].colSpan&&(!e||q+y<u);y++)k.push((t++==0?"":"\t")+A);k.push("\n")}}f=k.join("")}else if(b=="txt"){f=0;a=[];b=[];s=[];for(t=p=0;p<h.rows.length;p++){r=h.rows[p];if(!this.L5(r,c,i,p,l,g,w,x))if(r.cells){b[t]=[];s.push(r);var B=0;for(var z=q=0;q<r.cells.length&&(!e||q<u);q++)if(r.cells[q].style.display!="none"&&(!c||c=="row"||c=="col"&&n[q]||c=="cell"&&n[q]&&(p==l||o[p]))){var C=c=="cell"&&p!=l&&!o[p][q]?
"":tabletools2.x5.D0(tabletools2.x5.j1(r.cells[q]),true,true);A=r.cells[q].colSpan;for(y=0;y<A&&(!e||q+y<u);y++){if(p==0||a.length<=z||a[z+y]<C.length)a[z+y]=C.length;b[t][z+y]=C}z+=A;B++}if(B>f)f=B;t++}}for(p=0;p<b.length;p++){c=s[p].className.match(/tt_summary/)?s[p].title:"";v&&k.push(tabletools2.x5.J5(c,v),"\t");for(t=q=0;q<f;q++)q>=b[p].length?k.push("\t"+tabletools2.x5.J5("",a[q])):k.push((t++==0?"":"\t")+tabletools2.x5.J5(b[p][q],a[q]));k.push("\n")}f=k.join("")}tabletools2.c_.a1.reportSpeed&&
alert(tabletools2.c_.u7.itTook+tabletools2.x5.B0(new Date,m)+tabletools2.c_.u7.copyTime);f=f.replace(/\n$/,"");d||tabletools2.x5.y8(f);return f}},a_:{z2:function(){document.getElementById("contentAreaContextMenu")!=null&&document.getElementById("contentAreaContextMenu").addEventListener("popupshowing",this.n9,false);tabletools2.c_.u7={};for(var a=["styleStr","unsupportedType","filterTime","defaultFilterOption","beforeProceed"],b=["itTook","copyTime","sortStyleTime","arrangeRowTime","cannotDelete",
"cannotCopy","createPlaceholder"],c=0;c<a.length;c++)tabletools2.c_.u7[a[c]]=tabletools2.u6.GetStringFromName(a[c]);for(c=0;c<b.length;c++)tabletools2.c_.u7[b[c]]=tabletools2.u6.GetStringFromName(b[c])+" "},L3:function(a){var b=a.which==1?"left":a.which==3?"right":"",c=[],d=this.K7||" ";tabletools2.x5.b8(a)&&c.push("ctrl");a.altKey&&c.push("alt");a.shiftKey&&c.push("shift");return tabletools2.c_.s3[c.join("")+"+"+d+"+"+b]||""},L4:function(a){if(tabletools2.c_.j4(a+"Use","bool")){if(!tabletools2.c_.s3)tabletools2.c_.s3=
{};tabletools2.c_.s3[tabletools2.c_.j4(a+"CmdKey","str")+"+"+tabletools2.c_.j4(a+"AlphaKey","str")+"+"+tabletools2.c_.j4(a+"Mouse","str")]=a}},z8:function(a){var b=a.target;if(b.tagName!="menuitem"){b=tabletools2.x5.j6(b)||{};tabletools2.h0.J6=b;if(!(!b.h1||b.h1.rows.length<1||!b.v7)){tabletools2.x5.y2(b.h1);tabletools2.c_.s3={};for(var c=tabletools2.c_.n4,d=0;d<c.length;d++)for(var e=0;e<c[d].length;e++)this.L4(c[d][e]);c=[["preserveStyle","str"],["reportSpeed","bool"],["showShortcuts","bool"],["showSumLabels",
"bool"],["copyHeading4Row","bool"],["copyHeading4Cell","bool"],["defaultDateStyle","str"],["decimalPoint","str"],["initSortDir","str"],["delayFilterFill","bool"],["delayFilterFill","bool"]];d=[["minimumSortRow",3],["tableHeadRow",0],["tableNoHeadRow",1]];if(!tabletools2.c_.a1)tabletools2.c_.a1={};for(e=0;e<c.length;e++)tabletools2.c_.a1[c[e][0]]=tabletools2.c_.j4(c[e][0],c[e][1]);for(e=0;e<d.length;e++)tabletools2.c_.a1[d[e][0]]=d[e][1];if(e=this.L3(a)){a.stopPropagation();a.preventDefault();if(tabletools2.b9&&
a.which==3)(a=document.getElementById("contentAreaContextMenu"))&&a.hidePopup();this.K7=""}this.b_(e,b)}}},K7:"",z7:function(a){var b=String.fromCharCode(a.keyCode);if(b.match(/[a-z]/i))this.K7=b;if(b.match(/[rR]/)&&a.altKey&&tabletools2.x5.b8(a)){tabletools2.c_.m3("useRestart","bool");if(tabletools2.c_.a1.useRestart)try{Components.classes["@mozilla.org/toolkit/app-startup;1"].getService(Components.interfaces.nsIAppStartup).quit(Components.interfaces.nsIAppStartup.eRestart|Components.interfaces.nsIAppStartup.eAttemptQuit)}catch(c){alert(c)}}},
y7:function(a){if(String.fromCharCode(a.keyCode)==this.K7)this.K7=""},n9:function(){var a=tabletools2.h0.J6;a=!a.v7||!a.h1||a.h1.rows.length<tabletools2.c_.a1.minimumSortRow;document.getElementById("tabletools2_mainmenu").hidden=a;if(!a){a=tabletools2.c_.n4;for(var b=tabletools2.c_.K0,c=["ctrl","ctrlalt","ctrlshift","left","right"],d={},e=0;e<c.length;e++)d[c[e]]=tabletools2.u6.GetStringFromName((tabletools2.b9&&e<3?"mac":"")+c[e]+"ContextMenu");for(c=0;c<a.length;c++)for(e=0;e<a[c].length;e++)if(b[a[c][e]]){var g=
document.getElementById(b[a[c][e]]);g.getAttribute("label");var h=tabletools2.c_.j4(a[c][e]+"AlphaKey","str");h=h!=" "?h+"+":"";g.setAttribute("acceltext",tabletools2.c_.a1.showShortcuts?d[tabletools2.c_.j4(a[c][e]+"CmdKey","str")]+"+"+h+d[tabletools2.c_.j4(a[c][e]+"Mouse","str")]:"")}}},b_:function(a,b,c){b=b||tabletools2.h0.J6;var d=b.h1,e=b.v7;tabletools2.h0.A5(b.h1);if(a&&a.match(/numsort/)){a=a.replace("num","");c="number"}switch(a){case "settype":b.j8.setAttribute("ttType",c);break;case "hidecolumn":tabletools2.x5.B7(d,
b.e9);break;case "unhidecolumns":tabletools2.x5.z9(d);break;case "summary":tabletools2.H5.A3(b);break;case "chart":tabletools2.K4.y9(b);break;case "addtable":tabletools2.d3.A7(b);break;case "comparetable":tabletools2.d3.A7(b,"compare");break;case "showcombined":tabletools2.d3.A0();break;case "clearcombined":tabletools2.d3.y6();break;case "tabletop":tabletools2.x5.z6(d);break;case "tablefoot":tabletools2.x5.z5(d);break;case "sort":tabletools2.h0.o2=false;tabletools2.h0.C3(e,b,null,c);break;case "multisort":tabletools2.h0.o2=
true;tabletools2.h0.C3(e,b,null,c);break;case "dropdown":tabletools2.g9.C9(b,2);break;case "sortdown":tabletools2.h0.C0(b,"up");break;case "sortup":tabletools2.h0.C0(b,"down");break;case "clearsort":tabletools2.h0.A4(d);break;case "search":tabletools2.g9.C9(b,1);break;case "filters":tabletools2.g9.C9(b,3);break;case "copyhtml":tabletools2.e3.e3(b,"html");break;case "copytab":tabletools2.e3.e3(b,"tab");break;case "copytext":tabletools2.e3.e3(b,"txt");break;case "copytabrows":tabletools2.e3.e3(b,"tab",
"row");break;case "copytextrows":tabletools2.e3.e3(b,"txt","row");break;case "copytabcols":tabletools2.e3.e3(b,"tab","col");break;case "copytextcols":tabletools2.e3.e3(b,"txt","col");break;case "copytabcells":tabletools2.e3.e3(b,"tab","cell");break;case "copytextcells":tabletools2.e3.e3(b,"txt","cell");break;case "cleanhighlight":tabletools2.x5.y5(d);break;case "resetdd":tabletools2.g9.q4(b.h1,2);break;case "resets":tabletools2.g9.q4(b.h1,1);break;case "resetb":tabletools2.g9.q4(b.h1)}}},c_:{n2:function(a,
b){if(this.j4(a,"bool"))return document.getElementById(b).checked=true;return false},n3:function(a,b,c){a=this.j4(a,c||"str");return document.getElementById(b).value=a},r3:function(a,b){return this.s0(a,document.getElementById(b).checked,"bool")},r7:function(a,b,c){return this.s0(a,document.getElementById(b).value,c||"str")},e6:function(a,b,c,d){var e=document.createElement("menulist"),g=document.createElement("menupopup");e.id=a;e.appendChild(g);for(a=0;a<b.length;a++){var h=document.createElement("menuitem");
h.setAttribute("value",b[a]);h.setAttribute("label",c?tabletools2.u6.GetStringFromName(d?d[a]:b[a]):b[a]==" "?" ":b[a]+" +");g.appendChild(h)}return e},K0:{sort:"tabletools2_sortmenu_sort",multisort:"tabletools2_sortmenu_multisort",numsort:"tabletools2_sortmenu_numsort",multinumsort:"tabletools2_sortmenu_multinumsort",sortdown:"tabletools2_othermenu_sortdownonly",sortup:"tabletools2_othermenu_sortuponly",clearsort:"tabletools2_othermenu_clearsort",dropdown:"tabletools2_filtermenu_dropdown",search:"tabletools2_filtermenu_search",
filters:"tabletools2_filtermenu_both",resetdd:"tabletools2_resetfilter_dropdown",resets:"tabletools2_resetfilter_search",resetb:"tabletools2_resetfilter_both",copytab:"tabletools2_copymenu_tab",copytext:"tabletools2_copymenu_txt",copyhtml:"tabletools2_copymenu_html",copytabrows:"tabletools2_copymenu_rowstab",copytextrows:"tabletools2_copymenu_rowstxt",copytabcols:"tabletools2_copymenu_colstab",copytextcols:"tabletools2_copymenu_colstxt",copytabcells:"tabletools2_copymenu_cellstab",copytextcells:"tabletools2_copymenu_cellstxt",
addtable:"tabletools2_othermenu_addtable",comparetable:"tabletools2_othermenu_comparetable",showcombined:"tabletools2_othermenu_showcombined",clearcombined:"tabletools2_othermenu_clearcombined",tablefoot:"tabletools2_othermenu_scrollsum",hidecolumn:"tabletools2_othermenu_hidecol",unhidecolumns:"tabletools2_othermenu_showcols",cleanhighlight:"tabletools2_othermenu_clearmatched",tabletop:"tabletools2_othermenu_scrolltop",summary:"tabletools2_summenu",chart:"tabletools2_chartmenu"},n4:[["move","sort",
"multisort","numsort","multinumsort","summary","chart","sortdown","sortup","clearsort","hidecolumn","unhidecolumns","tabletop","tablefoot","cleanhighlight"],["dropdown","search","resetdd","resets","addtable","comparetable","showcombined","clearcombined","copyhtml","copytab","copytext","copytabrows","copytextrows","copytabcols","copytextcols","copytabcells","copytextcells"]],d_:function(){var a=this.n4,b=[" ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W",
"X","Y","Z"],c=[document.getElementById("tabletools2_ks_mainfunc"),document.getElementById("tabletools2_ks_copyfunc")];this.s3={};for(var d=0;d<a.length;d++)for(var e=0;e<a[d].length;e++){var g=document.createElement("hbox");g.setAttribute("flex","1");g.setAttribute("align","center");var h=document.createElement("checkbox");h.id="tabletools2_ks_"+a[d][e];h.setAttribute("label",tabletools2.u6.GetStringFromName("use"));g.appendChild(h);g.appendChild(this.e6(h.id+1,["ctrl","ctrlalt","ctrlshift"],true,
tabletools2.b9?["macctrl","macctrlalt","macctrlshift"]:null));g.appendChild(this.e6(h.id+2,b));g.appendChild(this.e6(h.id+3,["left","right"],true));var f=document.createElement("label");f.setAttribute("value",tabletools2.u6.GetStringFromName(a[d][e]));g.appendChild(f);c[d].appendChild(g);g=this.n2(a[d][e]+"Use",h.id);f=this.n3(a[d][e]+"CmdKey",h.id+1);var k=this.n3(a[d][e]+"AlphaKey",h.id+2);h=this.n3(a[d][e]+"Mouse",h.id+3);if(g)this.s3[f+"+"+k+"+"+h]=true}this.n2("reportSpeed","tabletools2_time_used");
this.n2("delayFilterFill","tabletools2_filter_delay");this.n2("showShortcuts","tabletools2_show_shortcuts");this.n2("showSumLabels","tabletools2_show_sum_labels");this.n2("copyHeading4Row","tabletools2_copy_heading_row");this.n2("copyHeading4Cell","tabletools2_copy_heading_cell");this.n2("useRestart","tabletools2_use_restart");this.n3("initSortDir","tabletools2_sort_dir");this.n3("defaultDateStyle","tabletools2_date_style");this.n3("decimalPoint","tabletools2_decimal_point");this.n3("preserveStyle",
"tabletools2_preserve_style")},m3:function(a,b){if(!tabletools2.c_.a1)tabletools2.c_.a1={};tabletools2.c_.a1[a]=tabletools2.c_.j4(a,b)},e_:function(){var a=this.n4;this.s3={};for(var b=0;b<a.length;b++)for(var c=0;c<a[b].length;c++){var d="tabletools2_ks_"+a[b][c],e=this.r3(a[b][c]+"Use",d),g=this.r7(a[b][c]+"CmdKey",d+1),h=this.r7(a[b][c]+"AlphaKey",d+2);d=this.r7(a[b][c]+"Mouse",d+3);if(e)this.s3[g+"+"+h+"+"+d]=true}this.r3("reportSpeed","tabletools2_time_used");this.r3("delayFilterFill","tabletools2_filter_delay");
this.r3("showShortcuts","tabletools2_show_shortcuts");this.r3("showSumLabels","tabletools2_show_sum_labels");this.r3("copyHeading4Row","tabletools2_copy_heading_row");this.r3("copyHeading4Cell","tabletools2_copy_heading_cell");this.r3("useRestart","tabletools2_use_restart");this.r7("initSortDir","tabletools2_sort_dir");this.r7("defaultDateStyle","tabletools2_date_style");this.r7("decimalPoint","tabletools2_decimal_point");this.r7("preserveStyle","tabletools2_preserve_style")},p:Components.classes["@mozilla.org/preferences-service;1"].getService(Components.interfaces.nsIPrefService).getBranch("extensions.tabletools2."),
j4:function(a,b){if(!b||b=="string"||b=="str")return this.p.getCharPref(a);if(b=="boolean"||b=="bool")return this.p.getBoolPref(a);if(b=="int")return this.p.getIntPref(a)},s0:function(a,b,c){if(!c||c.match(/^(string|str)$/))this.p.setCharPref(a,b);else if(c=="int")this.p.setIntPref(a,b);else if(c=="boolean"||c=="bool")this.p.setBoolPref(a,b);return b}},u1:{k7:null,u3:function(a){tabletools2.a_.L4("move");if(tabletools2.a_.L3(a)=="move"){var b=tabletools2.x5.j6(a.target);if(b.v7){this.k7={k3:b,x:a.pageX,
y:a.pageY,k5:this.m0(b.v7),k4:this.m0(b.w6),k6:this.m0(b.h1)};this.dragFn=tabletools2.x5.y3({g3:window,x1:"mousemove",i1:tabletools2.u1.u5,q9:tabletools2.u1});a.preventDefault()}}},m0:function(a){var b=0,c=0;do{b+=a.offsetLeft;c+=a.offsetTop}while(a=a.offsetParent);return{x:b,y:c}},c8:function(a,b){var c=a.cloneNode(true),d=[c],e=a;do{e=e.parentNode;c=e.cloneNode(false);d.push(c)}while(!/TABLE/i.test(e.tagName));for(e=d.length-1;e;e--)d[e].appendChild(d[e-1]);b&&b.appendChild(c);return c},u5:function(a){var b=
this.k7.k3,c=this.k7.m1,d=a.pageX-this.k7.x;a=a.pageY-this.k7.y;if(!c){var e=b.h1.ownerDocument,g;this.k7.m1=e.createElement("div");c=this.k7.m1;e.body.appendChild(c);c.style.cssText="border:1px solid red;position:absolute;background-color:rgb(200,200,255)";if(b.v7.cellIndex){c.style.height=b.h1.offsetHeight+"px";c.style.width=b.v7.offsetWidth+"px";e=this.k7.k5.x;g=this.k7.k6.y;this.c8(b.j8,c)}else{c.style.height=b.w6.offsetHeight+"px";c.style.width=b.w6.offsetWidth+"px";g=this.k7.k4.y;e=this.k7.k4.x;
this.c8(b.w6,c)}this.k7.l1=e;this.k7.l2=g;c.style.top=g+"px";c.style.left=e+"px";(b=b.h1.ownerDocument.defaultView.getSelection())&&b.removeAllRanges()}c.style.left=this.k7.l1+d+"px";c.style.top=this.k7.l2+a+"px"},u4:function(a){if(this.k7){tabletools2.x5.removeEvent({g3:window,x1:"mousemove",i1:this.dragFn});a.preventDefault();var b=this.k7,c=b.k3,d=b.m1,e=c.h1;this.k7=null;if(d){try{if(c.v7.cellIndex){for(var g=c.m9.cells,h=b.l1+(a.pageX-b.x),f=0;f<g.length;f++){var k=this.m0(g[f]);if(h<k.x&&f!=
c.k2){tabletools2.x5.d4(e,c.k2,f);break}}f==g.length&&f-1!=c.k2&&tabletools2.x5.d4(e,c.k2,f-1)}else{var m=b.l2+(a.pageY-b.y),i=c.w6.rowIndex;k=this.m0(c.w6);if(m<k.y){for(f=i-1;f>=0;f--){k=this.m0(e.rows[f]);if(m>k.y)break}f++}else for(f=i+1;f<e.rows.length;f++){k=this.m0(e.rows[f]);if(m<k.y)break}f!=i&&tabletools2.x5.e2(e,i,f)}}catch(n){}e.ownerDocument.body.removeChild(d)}}}}};tabletools2.x5.y3({g3:window,x1:"mousedown",i1:tabletools2.u1.u3,q9:tabletools2.u1});tabletools2.x5.y3({g3:window,x1:"mouseup",
i1:tabletools2.u1.u4,q9:tabletools2.u1});tabletools2.x5.y3({g3:window,x1:"click",i1:tabletools2.a_.z8,q9:tabletools2.a_});tabletools2.x5.y3({g3:window,x1:"load",i1:tabletools2.a_.z2,q9:tabletools2.a_});tabletools2.x5.y3({g3:window,x1:"keydown",i1:tabletools2.a_.z7,q9:tabletools2.a_});tabletools2.x5.y3({g3:window,x1:"keyup",i1:tabletools2.a_.y7,q9:tabletools2.a_})};
